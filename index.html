<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Birthday Surprise</title>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.js"></script>
<style>
  html, body {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #000;
    touch-action: none;
    font-family: 'Comic Sans MS', cursive;
  }
  canvas {
    display: block;
    width: 100vw;
    height: 100vh;
  }
  #nameInputDiv {
    position:absolute; 
    top:50%; left:50%; transform:translate(-50%,-50%);
    text-align:center; color:white;
    z-index:10;
  }
  input, button { 
    padding:10px 15px; 
    border-radius:10px; 
    border:none; 
    margin-top:10px; 
    font-size:16px; 
  }
  button { background:#ff6699; color:white; cursor:pointer; }
</style>
</head>
<body>
<div id="nameInputDiv">
  <h2>Welcomee ji!!üéà<br>Avi gyo emne Rishudaaüòπ<br>chl hve "mara Teddy" nu name enter kar<br>ane Aagad jo babyyüòâ</h2>
  <input type="text" id="nameInput" placeholder="name..."><br>
  <button id="startBtn">go for Surprise‚ú®</button>
  <p id="error" style="color:red"></p>
</div>

<script>
let playerName = "";
const correctName = "Rishit";

document.getElementById("startBtn").onclick = () => {
  const nameValue = document.getElementById("nameInput").value.trim();
  if(nameValue.toLowerCase() === correctName.toLowerCase()){
    playerName = nameValue;
    document.getElementById("nameInputDiv").style.display = "none";
    startPhaser();
  } else {
    document.getElementById("error").innerText = "You are not my best friend!üò°" ;
  }
};

function startPhaser(){
  const config = {
    type: Phaser.AUTO,
    width: window.innerWidth,
    height: window.innerHeight,
    backgroundColor:"#000000",
    physics: { default:"arcade" },
    scene: [BirthdayScene],
    scale: {
      mode: Phaser.Scale.RESIZE,       // ‚úÖ responsive scaling
      autoCenter: Phaser.Scale.CENTER_BOTH
    }
  };
  const game = new Phaser.Game(config);

  // ‚úÖ Update game size when screen resizes or mobile bars move
  window.addEventListener("resize", () => {
    game.scale.resize(window.innerWidth, window.innerHeight);
  });
}

class BirthdayScene extends Phaser.Scene{
  constructor(){ 
    super("BirthdayScene"); 
    this.smallFireworkIntensity = 0;
  }
  
  preload(){
    this.load.image("balloon","balloon.png");
    this.load.image("gift","gift.png");
    this.load.image("photo1","photo1.jpg");
    this.load.image("photo2","photo2.jpg");
    this.load.image("photo3","photo3.jpg");
    this.load.image("photo4","photo4.jpg");
    this.load.image("photo5","photo5.jpg");

    this.load.audio("rocket","rocket.mp3");
    this.load.audio("bigExplosion","big_explosion.mp3");
    this.load.audio("giftOpen","gift_open.mp3");
    this.load.audio("balloonRise","balloon_rise.mp3");
    this.load.audio("balloonPop","balloon_pop.mp3");
    this.load.audio("finalMsg","final_msg.mp3");
    this.load.audio("smallFireworks","small_fireworks.mp3");
  }

  create(){
    this.centerX = this.scale.width / 2;
    this.centerY = this.scale.height / 2;

    this.messages = [
      "First memory ‚Äî Apdo sav thi first photo...yd chr??aa divase su thyu tu?üòÇ",
      "Mara Rishudaa ni First Birthdayyy..‚ù§Ô∏è",
      "Winkk.. First timeeüòÇ..Tyare kevo sharmato tu wink karvamaüòÇ",
      "Tyare kya khbr hati k atlo saro bond bani jasee...my sukoonü´∂",
      "And now its 3rd year and you're still...holding a very special place in my heartüíû"
    ];

    this.launchBigFirework();
  }

  createSparkTrail(x,y,color){
    const spark = this.add.circle(x,y,Phaser.Math.Between(1,3),color).setAlpha(0.9);
    this.tweens.add({
      targets:spark,
      x:x+Phaser.Math.Between(-15,15),
      y:y+Phaser.Math.Between(-15,15),
      alpha:{from:0.9,to:0},
      scale:{from:1,to:0.2},
      duration:Phaser.Math.Between(300,600),
      onComplete:()=>spark.destroy()
    });
  }

  launchBigFirework(){
    const x = this.centerX;
    const y = this.centerY + this.scale.height * 0.15;
    const rocket = this.add.circle(x, this.scale.height, 10, 0xffffff);

    this.sound.context.resume().then(() => {
      this.sound.play("rocket");
    });

    this.tweens.add({
      targets: rocket,
      y: y,
      duration: 1000,
      ease: "Cubic.easeOut",
      onUpdate: () => {
        const color = Phaser.Display.Color.RandomRGB();
        this.createSparkTrail(rocket.x, rocket.y, color.color);
      },
      onComplete: () => {
        rocket.destroy();
        this.sound.play("bigExplosion");

        const explosionParticles = 400;
        for (let i = 0; i < explosionParticles; i++) {
          const color = Phaser.Display.Color.RandomRGB();
          const particle = this.add.circle(x, y, Phaser.Math.Between(8, 15), color.color);
          const angle = Phaser.Math.FloatBetween(0, Math.PI * 2);
          const distance = Phaser.Math.Between(200, 500);
          const duration = Phaser.Math.Between(1500, 2500);

          this.tweens.add({
            targets: particle,
            x: particle.x + Math.cos(angle) * distance,
            y: particle.y + Math.sin(angle) * distance,
            alpha: { from: 1, to: 0 },
            scale: { from: 1, to: 0.5 },
            duration: duration,
            ease: "Cubic.easeOut",
            onUpdate: () => this.createSparkTrail(particle.x, particle.y, color.color),
            onComplete: () => particle.destroy()
          });
        }

        this.smallFireworksSound = this.sound.add("smallFireworks");
        this.smallFireworksSound.play({loop:true});
        this.showBirthdayWish();
      }
    });
  }

  showBirthdayWish(){
    this.wishText = this.add.text(this.centerX,this.centerY,
      `Wishingg youhh a very very \nHappiestt Birthdayy mara Laddlaaü´Çüòò\nI wish k Bhagwan tane Hamesha\nKhush Rakhe Rishudiiiüíï`,
      {fontSize:`24px`, color:"#fff", fontStyle:"bold", align:"center"}).setOrigin(0.5).setAlpha(0);

    this.tweens.add({
      targets:this.wishText,
      alpha:1,
      duration:2000,
      onComplete:()=> {
        this.smallFireworksTimer = this.time.addEvent({
          delay:300, loop:true, callback:()=>this.launchSmallFirework()
        });
        this.time.delayedCall(7000,()=>this.showWaitMessages());
      }
    });
  }

  launchSmallFirework(){
    const startX = Phaser.Math.Between(50,this.scale.width-50);
    const startY = this.scale.height;
    const targetY = Phaser.Math.Between(this.centerY/2,this.centerY);
    const rocket = this.add.circle(startX,startY,6,Phaser.Display.Color.RandomRGB().color);

    this.tweens.add({
      targets:rocket,
      y:targetY,
      duration:800,
      ease:"Cubic.easeOut",
      onUpdate:()=> this.createSparkTrail(rocket.x,rocket.y,Phaser.Display.Color.RandomRGB().color),
      onComplete:()=>{
        for(let i=0;i<25;i++){
          const color = Phaser.Display.Color.RandomRGB();
          const particle = this.add.circle(rocket.x,rocket.y,5,color.color);
          const angle = Phaser.Math.FloatBetween(0,Math.PI*2);
          const distance = Phaser.Math.Between(60,120);
          const duration = Phaser.Math.Between(800,1500);
          this.tweens.add({
            targets:particle,
            x:particle.x+Math.cos(angle)*distance,
            y:particle.y+Math.sin(angle)*distance,
            alpha:{from:1,to:0},
            duration:duration,
            ease:"Cubic.easeOut",
            onComplete:()=>particle.destroy()
          });
        }
        rocket.destroy();
      }
    });
  }

  showWaitMessages(){
    this.tweens.add({targets:this.wishText, alpha:0, duration:1000});
    const messages=["wait...","wait...","wait..‚úã","here's something for youhh my darlingg‚ù§Ô∏è"];
    let yPos=this.centerY, delay=1700;
    messages.forEach((msg,i)=> this.time.delayedCall(delay*(i+1),()=>this.typeMessage(msg,yPos)));
  }

  typeMessage(msg,yPos){
    if(this.messageText) this.messageText.destroy();
    this.messageText = this.add.text(this.centerX,yPos,"",{fontSize:"30px",color:"#fff",fontStyle:"bold"}).setOrigin(0.5);
    let idx=0;
    this.time.addEvent({
      delay:100,
      callback:()=>{
        this.messageText.text+=msg[idx];
        idx++;
        if(idx>=msg.length && msg.includes("darlingg")){
          this.time.delayedCall(1000,()=>this.showGiftButton());
        }
      },
      repeat:msg.length-1
    });
  }

  showGiftButton(){
    this.messageText.setAlpha(0);
    this.gift = this.add.image(this.centerX,this.centerY,"gift").setScale(0.35).setInteractive();
    this.giftMsg = this.add.text(this.centerX,this.centerY+200,"Click to open bebuuuüòò",{fontSize:"22px",color:"#fff"}).setOrigin(0.5);
    this.tweens.add({targets:this.gift, y:this.centerY-10, yoyo:true, repeat:-1, duration:800});

    this.gift.on("pointerdown",()=>{
      if(this.smallFireworksSound) this.smallFireworksSound.stop();
      this.sound.play("giftOpen");
      if(this.smallFireworksTimer) this.smallFireworksTimer.remove(false);
      this.tweens.add({targets:[this.gift,this.giftMsg], alpha:0, duration:800, onComplete:()=>this.startBalloonScene()});
    });
  }

  startBalloonScene(){
    this.cameras.main.fadeOut(800,255,182,193);
    this.time.delayedCall(900,()=>{
      this.cameras.main.setBackgroundColor("#ffd6e7");
      this.cameras.main.fadeIn(800);
      this.createBalloons();
    });
  }

  createBalloons(){
    this.photoSprites=[];
    this.centerX = this.scale.width/2;
    this.centerY = this.scale.height/2;

    const positions=[
      [this.centerX-180,this.centerY-120],
      [this.centerX+180,this.centerY-120],
      [this.centerX,this.centerY],
      [this.centerX-150,this.centerY+120],
      [this.centerX+150,this.centerY+120]
    ];

    positions.forEach((pos,i)=>{
      this.time.delayedCall(i*600,()=>{
        this.sound.play("balloonRise");
        let balloon = this.add.image(pos[0],this.scale.height+80,"balloon").setScale(0.3);
        this.tweens.add({targets:balloon, y:pos[1], duration:900, ease:"Back.Out"});
        this.time.delayedCall(3500+i*800,()=>this.popBalloon(balloon,i));
      });
    });
  }

  popBalloon(balloon,i){
    const bx=balloon.x, by=balloon.y;
    this.tweens.add({
        targets:balloon,
        scale:{from:0.3,to:0.6},
        alpha:{from:1,to:0},
        duration:500,
        onComplete:()=>{
            this.sound.play("balloonPop");
            balloon.destroy();

            const photoKey=`photo${i+1}`;
            const photo = this.add.image(bx,by,photoKey);

            const maxWidth = this.scale.width * 0.25;
            const maxHeight = this.scale.height * 0.25;
            const scaleX = maxWidth / photo.width;
            const scaleY = maxHeight / photo.height;
            const scale = Math.min(scaleX, scaleY);
            photo.setScale(scale);

            photo.setAlpha(0);

            const msg = this.add.text(
                bx, by + photo.displayHeight/2+25, 
                this.messages[i],
                {fontSize:"12px", color:"#333", align:"center", wordWrap:{width:maxWidth}}
            ).setOrigin(0.5).setAlpha(0);

            this.tweens.add({targets:photo, alpha:1, scale:{from:0.5,to:scale}, ease:"Back.Out", duration:800});
            this.tweens.add({targets:msg, alpha:1, duration:800});
            this.photoSprites.push(photo,msg);

            if(i===4) this.time.delayedCall(18000,()=>this.showEndingScreen());
        }
    });
  }

  showEndingScreen(){
    this.sound.play("finalMsg");
    this.tweens.add({targets:this.photoSprites, alpha:0, duration:1700});
    this.time.delayedCall(1500,()=>{
      this.cameras.main.fadeOut(1000,255,214,231);
      this.time.delayedCall(2400,()=>{
        this.cameras.main.setBackgroundColor("#1a1333");
        this.cameras.main.fadeIn(1200);

        const finalText=this.add.text(this.centerX,this.centerY,
          "Happiest Birthday to my Special One..ü´∂‚ù§Ô∏è\n... (rest of your long message here) ...",
          {fontSize:Math.floor(this.scale.width/90), color:"#ffccff", align:"center", wordWrap:{width:this.scale.width*0.9}}
        ).setOrigin(0.5).setAlpha(0);

        this.tweens.add({targets:finalText, alpha:1, duration:2000});
      });
    });
  }
}
</script>
</body>
</html>
